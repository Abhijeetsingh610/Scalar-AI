(()=>{var e={};e.id=892,e.ids=[892],e.modules={5236:e=>{function r(e){var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}r.keys=()=>[],r.resolve=r,r.id=5236,e.exports=r},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4300:e=>{"use strict";e.exports=require("buffer")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},7310:e=>{"use strict";e.exports=require("url")},9796:e=>{"use strict";e.exports=require("zlib")},2481:(e,r,t)=>{"use strict";t.r(r),t.d(r,{originalPathname:()=>g,patchFetch:()=>q,requestAsyncStorage:()=>m,routeModule:()=>p,serverHooks:()=>f,staticGenerationAsyncStorage:()=>x});var s={};t.r(s),t.d(s,{GET:()=>l,POST:()=>d});var a=t(3277),o=t(5265),n=t(5356),i=t(6460),c=t(6701),u=t(7076);async function l(e){try{let e=(0,i.createRouteHandlerClient)({cookies:c.cookies}),{data:r,error:t}=await e.from("masterclasses").select("*").eq("is_active",!0).order("scheduled_date",{ascending:!0});if(t)return console.error("Supabase error:",t),u.NextResponse.json({error:"Failed to fetch masterclasses"},{status:500});return u.NextResponse.json({success:!0,data:r})}catch(e){return console.error("API error:",e),u.NextResponse.json({error:"Internal server error"},{status:500})}}async function d(e){try{let{leadId:r,masterclassId:t}=await e.json();if(!r||!t)return u.NextResponse.json({error:"Missing required fields"},{status:400});let s=(0,i.createRouteHandlerClient)({cookies:c.cookies}),{data:a,error:o}=await s.from("masterclass_registrations").insert([{lead_id:r,masterclass_id:t,registered_at:new Date().toISOString()}]).select();if(o){if("23505"===o.code)return u.NextResponse.json({error:"Already registered for this masterclass"},{status:409});return console.error("Supabase error:",o),u.NextResponse.json({error:"Failed to register for masterclass"},{status:500})}let{data:n,error:l}=await s.from("masterclasses").select("current_attendees").eq("id",t).single();if(!l&&n){let{error:e}=await s.from("masterclasses").update({current_attendees:n.current_attendees+1}).eq("id",t);e&&console.error("Failed to update attendee count:",e)}return await s.from("leads").update({conversion_stage:"Warm"}).eq("id",r),u.NextResponse.json({success:!0,data:a?.[0]})}catch(e){return console.error("Registration API error:",e),u.NextResponse.json({error:"Internal server error"},{status:500})}}let p=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/masterclasses/route",pathname:"/api/masterclasses",filename:"route",bundlePath:"app/api/masterclasses/route"},resolvedPagePath:"D:\\scaler-project\\Scalar-AI\\app\\api\\masterclasses\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:m,staticGenerationAsyncStorage:x,serverHooks:f}=p,g="/api/masterclasses/route";function q(){return(0,n.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:x})}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[916,786,664,459,583],()=>t(2481));module.exports=s})();